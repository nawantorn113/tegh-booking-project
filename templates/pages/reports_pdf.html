{% load static %}
<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>{{ report_title }}</title>
    <style>
        /* กำหนดฟอนต์ภาษาไทย (ต้องมีไฟล์ฟอนต์ใน static หรือใช้ Google Fonts แบบ Base64) */
        @font-face {
            font-family: 'Kanit';
            /* ถ้าไม่มีไฟล์ฟอนต์ในเครื่อง อาจจะแสดงผลภาษาไทยเป็นสี่เหลี่ยม */
            /* แนะนำให้โหลดไฟล์ .ttf มาวางใน static/fonts/ แล้วชี้ path ให้ถูก */
            src: local('Kanit'), local('Arial'); 
        }
        body { font-family: 'Kanit', 'Arial', sans-serif; font-size: 14px; }
        h1 { text-align: center; color: #4a55a8; }
        table { width: 100%; border-collapse: collapse; margin-top: 20px; }
        th, td { border: 1px solid #ddd; padding: 8px; text-align: left; }
        th { background-color: #f2f2f2; font-weight: bold; }
        .badge { padding: 4px 8px; border-radius: 4px; color: white; font-size: 12px; }
        .bg-success { background-color: #198754; }
        .bg-warning { background-color: #ffc107; color: black; }
    </style>
</head>
<body>
    <h1>{{ report_title }}</h1>
    <p>ข้อมูล ณ วันที่: {{ export_date|date:"d/m/Y H:i" }}</p>
    <p>ออกรายงานโดย: {{ user.get_full_name|default:user.username }}</p>

    <table>
        <thead>
            <tr>
                <th>วันที่</th>
                <th>เวลา</th>
                <th>ห้อง</th>
                <th>หัวข้อ</th>
                <th>ผู้จอง</th>
                <th>แผนก</th>
                <th>สถานะ</th>
            </tr>
        </thead>
        <tbody>
            {% for b in bookings %}
            <tr>
                <td>{{ b.start_time|date:"d/m/Y" }}</td>
                <td>{{ b.start_time|date:"H:i" }} - {{ b.end_time|date:"H:i" }}</td>
                <td>{{ b.room.name }}</td>
                <td>{{ b.title }}</td>
                <td>{{ b.user.get_full_name|default:"-" }}</td>
                <td>{{ b.department|default:"-" }}</td>
                <td>
                    {% if b.status == 'APPROVED' %}
                        <span class="badge bg-success">อนุมัติ</span>
                    {% else %}
                        <span class="badge bg-warning">รออนุมัติ</span>
                    {% endif %}
                </td>
            </tr>
            {% empty %}
            <tr>
                <td colspan="7" style="text-align: center;">ไม่มีข้อมูลการจองในช่วงเวลานี้</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</body>
</html>