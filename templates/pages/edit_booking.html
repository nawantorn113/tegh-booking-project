{% extends 'base.html' %}
{% load static %}

{% block title %}р╣Бр╕Бр╣Йр╣Др╕Вр╕Бр╕▓р╕гр╕Ир╕нр╕З: {{ booking.title }}{% endblock %}
{% block page_title %}р╣Бр╕Бр╣Йр╣Др╕Вр╕Бр╕▓р╕гр╕Ир╕нр╕З{% endblock %}

{% block extra_head %}
{# Select2 CSS #}
{{ form.media.css }}
<link href="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/css/select2.min.css" rel="stylesheet" />
<link href="https://cdn.jsdelivr.net/npm/select2-bootstrap-5-theme@1.3.0/dist/select2-bootstrap-5-theme.min.css" rel="stylesheet" />

<style>
┬а ┬а body {
┬а ┬а ┬а ┬а background-color: #f8f9fa;
┬а ┬а }

┬а ┬а .form-container {
┬а ┬а ┬а ┬а max-width: 480px;
┬а ┬а ┬а ┬а margin: 50px auto;
┬а ┬а ┬а ┬а padding: 25px 30px;
┬а ┬а ┬а ┬а background: #ffffff;
┬а ┬а ┬а ┬а border-radius: 20px;
┬а ┬а ┬а ┬а box-shadow: 0 4px 12px rgba(0,0,0,0.1);
┬а ┬а }

┬а ┬а .form-label {
┬а ┬а ┬а ┬а font-weight: 600;
┬а ┬а ┬а ┬а margin-top: 10px;
┬а ┬а }

┬а ┬а .form-control, .select2-selection {
┬а ┬а ┬а ┬а border-radius: 10px !important;
┬а ┬а }

┬а ┬а /* ЁЯОп CSS р╕Ър╕▒р╕Зр╕Др╕▒р╕Ър╕Др╕зр╕▓р╕бр╕Бр╕зр╣Йр╕▓р╕З: р╕Др╕╡р╕вр╣Мр╕лр╕ер╕▒р╕Бр╕нр╕вр╕╣р╣Ир╕Чр╕╡р╣Ир╕Щр╕╡р╣И */
┬а ┬а .select2-container {
┬а ┬а ┬а ┬а min-width: 100% !important;
┬а ┬а ┬а ┬а width: 100% !important;
┬а ┬а ┬а ┬а display: block !important;
┬а ┬а }

┬а ┬а /* р╕Ыр╕гр╕▒р╕Ър╣Гр╕лр╣Йр╕кр╕╣р╕Зр╕Вр╕╢р╣Йр╕Щр╕лр╕Щр╣Ир╕нр╕в */
┬а ┬а .select2-selection--multiple {
┬а ┬а ┬а ┬а min-height: 45px !important;
┬а ┬а }

┬а ┬а .btn {
┬а ┬а ┬а ┬а border-radius: 10px;
┬а ┬а ┬а ┬а padding: 8px 20px;
┬а ┬а }

┬а ┬а .text-center {
┬а ┬а ┬а ┬а margin-top: 20px;
┬а ┬а }
</style>
{% endblock %}

{% block content %}
<div class="form-container">
┬а ┬а <h5 class="text-center mb-4"><strong>р╣Бр╕Бр╣Йр╣Др╕Вр╕Бр╕▓р╕гр╕Ир╕нр╕Зр╕лр╣Йр╕нр╕З: {{ booking.room.name }}</strong></h5>

┬а ┬а <form method="POST" enctype="multipart/form-data" id="bookingForm">
┬а ┬а ┬а ┬а {% csrf_token %}
┬а ┬а ┬а ┬а <div class="mb-3">
┬а ┬а ┬а ┬а ┬а ┬а <label class="form-label">р╕лр╕▒р╕зр╕Вр╣Йр╕нр╕Бр╕▓р╕гр╕Ыр╕гр╕░р╕Кр╕╕р╕б</label>
┬а ┬а ┬а ┬а ┬а ┬а {{ form.title }}
┬а ┬а ┬а ┬а </div>

┬а ┬а ┬а ┬а <div class="row">
┬а ┬а ┬а ┬а ┬а ┬а <div class="col">
┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а <label class="form-label">р╕Ыр╕гр╕░р╣Ар╕ар╕Ч (р╕Цр╣Йр╕▓р╕бр╕╡)</label>
┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а {{ form.meeting_type }}
┬а ┬а ┬а ┬а ┬а ┬а </div>
┬а ┬а ┬а ┬а ┬а ┬а <div class="col">
┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а <label class="form-label">р╣Бр╕Ьр╕Щр╕Бр╕Ьр╕╣р╣Йр╕Ир╕нр╕З</label>
┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а {{ form.department }}
┬а ┬а ┬а ┬а ┬а ┬а </div>
┬а ┬а ┬а ┬а </div>

┬а ┬а ┬а ┬а <div class="row">
┬а ┬а ┬а ┬а ┬а ┬а <div class="col">
┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а <label class="form-label">р╕зр╕▒р╕Щ/р╣Ар╕зр╕ер╕▓ р╣Ар╕гр╕┤р╣Ир╕бр╕Хр╣Йр╕Щ</label>
┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а {{ form.start_time }}
┬а ┬а ┬а ┬а ┬а ┬а </div>
┬а ┬а ┬а ┬а ┬а ┬а <div class="col">
┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а <label class="form-label">р╕зр╕▒р╕Щ/р╣Ар╕зр╕ер╕▓ р╕кр╕┤р╣Йр╕Щр╕кр╕╕р╕Ф</label>
┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а {{ form.end_time }}
┬а ┬а ┬а ┬а ┬а ┬а </div>
┬а ┬а ┬а ┬а </div>

┬а ┬а ┬а ┬а <div class="mb-3">
┬а ┬а ┬а ┬а ┬а ┬а <label class="form-label">р╕Ир╕│р╕Щр╕зр╕Щр╕Ьр╕╣р╣Йр╣Ар╕Вр╣Йр╕▓р╕гр╣Ир╕зр╕б</label>
┬а ┬а ┬а ┬а ┬а ┬а {{ form.participants_count }}
┬а ┬а ┬а ┬а </div>

┬а ┬а ┬а ┬а <div class="mb-3">
┬а ┬а ┬а ┬а ┬а ┬а <label class="form-label">р╕гр╕▓р╕вр╕Кр╕╖р╣Ир╕нр╕Ьр╕╣р╣Йр╣Ар╕Вр╣Йр╕▓р╕гр╣Ир╕зр╕б</label>
┬а ┬а ┬а ┬а ┬а ┬а <div class="participant-select">
┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а {{ form.participants }}
┬а ┬а ┬а ┬а ┬а ┬а </div>
┬а ┬а ┬а ┬а </div>

┬а ┬а ┬а ┬а <div class="mb-3">
┬а ┬а ┬а ┬а ┬а ┬а <label class="form-label">р╕гр╕▓р╕вр╕ер╕░р╣Ар╕нр╕╡р╕вр╕Фр╕Бр╕▓р╕гр╕Ыр╕гр╕░р╕Кр╕╕р╕б / р╕зр╕▓р╕гр╕░р╕Бр╕▓р╕гр╕Ыр╕гр╕░р╕Кр╕╕р╕б</label>
┬а ┬а ┬а ┬а ┬а ┬а {{ form.details }}
┬а ┬а ┬а ┬а </div>

┬а ┬а ┬а ┬а <div class="mb-3">
┬а ┬а ┬а ┬а ┬а ┬а <label class="form-label">р╣Др╕Яр╕ер╣Мр╣Ар╕нр╕Бр╕кр╕▓р╕г</label>
┬а ┬а ┬а ┬а ┬а ┬а {{ form.attachment }}
┬а ┬а ┬а ┬а </div>

┬а ┬а ┬а ┬а <div class="mb-3">
┬а ┬а ┬а ┬а ┬а ┬а <label class="form-label">р╕нр╕╕р╕Ыр╕Бр╕гр╕Ур╣Мр╣Ар╕Юр╕┤р╣Ир╕бр╣Ар╕Хр╕┤р╕б</label>
┬а ┬а ┬а ┬а ┬а ┬а {{ form.equipment }}
┬а ┬а ┬а ┬а </div>

┬а ┬а ┬а ┬а <div class="mb-3">
┬а ┬а ┬а ┬а ┬а ┬а <label class="form-label">р╕лр╕бр╕▓р╕вр╣Ар╕лр╕Хр╕╕</label>
┬а ┬а ┬а ┬а ┬а ┬а {{ form.note }}
┬а ┬а ┬а ┬а </div>

┬а ┬а ┬а ┬а <div class="text-center">
┬а ┬а ┬а ┬а ┬а ┬а <button type="button" class="btn btn-secondary" onclick="window.location.href='{% url 'history' %}'">р╕вр╕Бр╣Ар╕ер╕┤р╕Б</button>
┬а ┬а ┬а ┬а ┬а ┬а <button type="submit" class="btn btn-primary">р╕вр╕╖р╕Щр╕вр╕▒р╕Щ</button>
┬а ┬а ┬а ┬а </div>
┬а ┬а </form>
</div>
{% endblock %}

{% block extra_scripts %}
{# Select2 JS #}
{{ form.media.js }}
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/js/select2.full.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/js/i18n/th.js"></script>

<script>
$(document).ready(function() {
    
    // ЁЯТб р╕Яр╕▒р╕Зр╕Бр╣Мр╕Кр╕▒р╕Щр╕Ър╕▒р╕Зр╕Др╕▒р╕Ър╕Др╕зр╕▓р╕бр╕Бр╕зр╣Йр╕▓р╕З Select2 р╣Гр╕лр╣Йр╣Ар╕Хр╣Зр╕б 100% (р╕Др╕╡р╕вр╣Мр╕лр╕ер╕▒р╕Б)
    function fixSelect2Width() {
        // р╣Гр╕Кр╣Й #bookingForm р╣Ар╕Юр╕╖р╣Ир╕нр╣Гр╕лр╣Йр╣Ар╕ер╕╖р╕нр╕Б Select2 р╕Чр╕╡р╣Ир╕Цр╕╣р╕Бр╕Хр╣Йр╕нр╕Зр╣Бр╕ер╕░р╣Ар╕Ир╕▓р╕░р╕Ир╕З
        $('#bookingForm .select2-container').css({
            width: '100%',
            minWidth: '100%',
            maxWidth: '100%'
        });
    }

    // 1. р╕кр╕гр╣Йр╕▓р╕З Select2 р╕Фр╣Йр╕зр╕вр╕Бр╕▓р╕гр╕Ър╕▒р╕Зр╕Др╕▒р╕Ъ width: '100%' р╕Хр╕гр╕Зр╣Ж
    const $selects = $('select').select2({
        theme: 'bootstrap-5',
        language: 'th',
        width: '100%' // ЁЯСИ р╣Гр╕Кр╣Й '100%' р╕Хр╕гр╕Зр╣Ж
    });

    // 2. р╕Ър╕▒р╕Зр╕Др╕▒р╕Ър╕Др╕зр╕▓р╕бр╕Бр╕зр╣Йр╕▓р╕Зр╕Фр╣Йр╕зр╕в CSS р╕Чр╕▒р╕Щр╕Чр╕╡ (р╣Ар╕Ьр╕╖р╣Ир╕нр╣Др╕зр╣Й)
    fixSelect2Width(); 
    
    // 3. р╕Чр╕гр╕┤р╕Бр╣Ар╕Бр╕нр╕гр╣М: р╕кр╕▒р╣Ир╕Зр╣Гр╕лр╣Й Select2 р╕Др╕│р╕Щр╕зр╕Ур╕Др╕зр╕▓р╕бр╕Бр╕зр╣Йр╕▓р╕Зр╣Гр╕лр╕бр╣Ир╕Чр╕▒р╕Щр╕Чр╕╡! (р╕Чр╣Ир╕▓р╣Др╕бр╣Йр╕Хр╕▓р╕вр╣Бр╕Бр╣Йр╕Ър╕▒р╣Кр╕Б)
    var $participantsField = $('#id_participants');
    $participantsField.trigger('change.select2');
    
    // 4. р╣Ар╕гр╕╡р╕вр╕Бр╕Лр╣Йр╕│р╣Гр╕Щр╕Кр╣Ир╕зр╕Зр╕кр╕▒р╣Йр╕Щр╣Ж р╣Ар╕Юр╕╖р╣Ир╕нр╕Др╕зр╕▓р╕бр╕Кр╕▒р╕зр╕гр╣М
    setTimeout(function() {
        fixSelect2Width();
        $participantsField.trigger('change.select2'); // р╕вр╣Йр╕│р╕Бр╕▓р╕гр╕Др╕│р╕Щр╕зр╕Ур╕Лр╣Йр╕│
    }, 100); 
    
    // 5. р╕Ър╕▒р╕Зр╕Др╕▒р╕Ър╕Др╕зр╕▓р╕бр╕Бр╕зр╣Йр╕▓р╕Зр╣Ар╕бр╕╖р╣Ир╕нр╕бр╕╡р╕Бр╕▓р╕гр╣Ар╕Ыр╕ер╕╡р╣Ир╕вр╕Щр╕Вр╕Щр╕▓р╕Фр╕лр╕Щр╣Йр╕▓р╕Ир╕н
    $(window).on('resize', fixSelect2Width);

});
</script>
{% endblock %}